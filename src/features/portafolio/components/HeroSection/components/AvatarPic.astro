---
import { Image } from "astro:assets";
import avatar from "@/assets/photos/avatar.png";
import { cn } from "@/shared/lib/utils";
---

<div
  id="avatar-pic-container"
  class="relative flex rounded-full shadow-2xl shadow-indigo-500/15 opacity-0 transition-opacity duration-300"
>
  <Image
    src={avatar}
    alt="Avatar"
    loading="eager"
    fetchpriority="high"
    class={cn(
      `
        w-54 lg:w-100 xl:w-120
        aspect-square 
        rounded-full 
        md:bg-deep-background
        bg-linear-to-b 
        from-sky-400 dark:from-blue-600/80
        dark:via-blue-600/20
        to-blue-700 dark:to-black/80
        backdrop-blur-lg
        shadow-2xl
        shadow-sky-500/15 md:shadow-transparent
      `
    )}
  />
  <div
    class="absolute top-0 left-0 right-0 w-full h-full rounded-full bg-linear-to-b from-transparent to-indigo-950/5"
  >
  </div>
</div>

<script is:inline>
  (function () {
    const container = document.getElementById("avatar-pic-container");
    const img = container?.querySelector("img");

    if (!img || !container) return;

    function showAvatar() {
      container.classList.remove("opacity-0");
      container.classList.add("animate-fade-in-up");
    }

    if (img.complete) {
      showAvatar();
    } else {
      img.addEventListener("load", showAvatar);
    }
  })();
</script>
